<js>typeahead</js>
<js>handlebars</js>
<css>typeahead</css>
<div class="form-group">
    <label for="<k>Name</k>"> <l><k>Label</k></l>: <if value="<k>Required</k>" eq="1"><span class="required-star">*</span></if></label>
    <div class="input-group">
        <block>
            <span class="input-group-addon"><k>Prefix</k></span>
        </block>
        <k>HTML</k>
        <div id="#<k>ID</k>_Status" class="hidden">
            <div class="progress">
              <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                <span class="sr-only">100%</span>
              </div>
            </div>
        </div>
        <block>
            <span class="input-group-addon"><k>Postfix</k></span>
        </block>
        <input type="text" name="<k>Name</k>" id="<k>ID</k>_hidden" value="<k>HValue</k>"/>

    </div>
    <if value="<k>Help</k>" eq="1">
        <div class="help-block"><l><k>Entity</k>.Help:<k>Key</k></l></div>
    </if>
</div>

<jsrun>
    var dataset<k>ID</k> = new Bloodhound(
    {
        datumTokenizer: Bloodhound.tokenizers.obj.whitespace('ID'),
        queryTokenizer: Bloodhound.tokenizers.whitespace,
        remote: {
            url: '<k>Typeahead.Remote</k>%QUERY',
            limit: 25,
            wildcard: '%QUERY'
        }
    });

    dataset<k>ID</k>.initialize();

    $('#<k>ID</k>').typeahead(null, {
      name: 'dataset<k>ID</k>',
      displayKey: 'Title',
      templates:
      {
            empty:
            [
                '<div class="text-warning">',
                    'Пока ничего не найдено',
                '</div>'
            ].join('\n'),
            suggestion: Handlebars.compile(
                         '<div class="media">'
                        +'<div class="media-body">'
                        +'<div class="media-heading">{{Title}}</div>'
                        +'</div>'),
      },
      source: dataset<k>ID</k>.ttAdapter()
    }).on('typeahead:selected', function(e, datum)
    {
        $('#<k>ID</k>_hidden').val(datum.ID);
    }).on('typeahead:autocomplete', function (e)
    {
        $('#<k>ID</k>_hidden').val(datum.ID);
    }).on('typeahead:asyncrequest', function ($e, datum)
    {
        $('#<k>ID</k>_Status').show();
    })
    .on('typeahead:asyncreceive', function ($e, datum)
    {
        $('#<k>ID</k>_Status').hide();
    });
</jsrun>